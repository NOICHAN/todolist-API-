"use strict";(self["webpackChunktodolist_api"]=self["webpackChunktodolist_api"]||[]).push([[253],{5253:function(e,t,o){o.r(t),o.d(t,{default:function(){return W}});var a=o(3396),i=o(7139),s=o(9242),l=o(4870);const n=e=>((0,a.dD)("data-v-bbf0c89a"),e=e(),(0,a.Cn)(),e),c={class:"todoListView bg-half js-view"},r=n((()=>(0,a._)("h1",null,[(0,a._)("a",{href:"#"},"ONLINE TODO LIST")],-1))),u={key:0},d={class:"todo_sm"},p={href:"#"},v=["onClick"],_={key:1},f={class:"todo_sm"},k=(0,a.Uk)("登入"),g=(0,a.Uk)("註冊"),y={class:"conatiner todoListPage vhContainer"},h={key:0,class:"todoList_Content"},w={class:"inputBox"},m=["onClick"],x=n((()=>(0,a._)("i",{class:"js-addTodo"},"+",-1))),C=[x],$={class:"todoList_list"},T={class:"todoList_tab"},b=["onClick"],L={class:"todoList_items"},D={class:"todoList_item"},H=["checked","onChange"],j={href:"#"},z=["onClick"],M=["onClick"],U={class:"todoList_statistics"},I={class:"js-todoList_statistics"},O=(0,a.Uk)(" 個已完成項目"),V=["onClick"],A={key:1};var K={__name:"HomeView",setup(e){const t=(0,a.f3)("axios"),o=(0,a.f3)("$swal"),n=(0,l.iH)(""),x=(0,l.iH)([]),K=(0,l.iH)({todos:[]}),N=(0,l.iH)(""),P=(0,l.iH)([]),W=(0,l.iH)([{chtType:"全部",engType:"all"},{chtType:"待完成",engType:"undone"},{chtType:"已完成",engType:"done"}]),Y=(0,l.iH)("all"),B=async()=>{try{const{data:e}=await t.get("todos");K.value=e,x.value=K.value.todos}catch(e){o.fire({icon:"error",title:"失敗",text:"目前服務不可用，請之後重新在試。"})}},E=async()=>{try{if(!N.value)return void o.fire({icon:"error",title:"失敗",text:"欄位不可為空"});await t.post("todos",{todo:{content:N.value}}),N.value="",o.fire({icon:"success",title:"成功",text:"新增成功。"}),await B()}catch(e){o.fire({icon:"error",title:"失敗",text:`${e.response.data.message}`})}},S=async e=>{try{if(!N.value)return void o.fire({icon:"error",title:"失敗",text:"新增欄位亦是編輯欄位，欄位不可為空"});await t.put(`todos/${e}`,{todo:{content:N.value}}),N.value="",o.fire({icon:"success",title:"成功",text:"修改成功。"}),await B()}catch(a){o.fire({icon:"error",title:"失敗",text:`${a.response.data.message}`})}},Z=async e=>{try{await t.delete(`todos/${e}`),o.fire({icon:"success",title:"成功",text:"刪除成功。"}),await B()}catch(a){o.fire({icon:"error",title:"失敗",text:`${a.response.data.message}`})}},q=async()=>{try{const e=P.value;await Promise.all(e.map((e=>t.delete(`todos/${e.id}`)))),o.fire({icon:"success",title:"成功",text:"成功清除已完成項目。"}),await B()}catch(e){o.fire({icon:"error",title:"失敗",text:`${e.response.data.message}`})}},F=async e=>{try{await t.patch(`todos/${e}/toggle`),o.fire({icon:"success",title:"成功",text:"切換狀態成功。"}),await B()}catch(a){o.fire({icon:"error",title:"失敗",text:`${a.response.data.message}`})}},G=e=>{Y.value=e,x.value="all"===e?K.value.todos:"undone"===e?K.value.todos.filter((e=>null===e.completed_at)):K.value.todos.filter((e=>null!==e.completed_at))},J=async()=>{try{await t.delete("users/sign_out"),document.cookie="token=; max-age=1;",document.cookie="nickname=; max-age=1;",t.defaults.headers.common.Authorization=document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=\s*([^;]*).*$)|^.*$/,"$1"),n.value="",o.fire({icon:"success",title:"成功",text:"登出成功。"})}catch(e){o.fire({icon:"error",title:"失敗",text:`${e.response.data.message}`})}};return(0,a.m0)((async()=>{P.value=await K.value.todos.filter((e=>null!==e.completed_at)),console.log(K.value.todos),console.log(P.value)})),(0,a.bv)((()=>{const e=document.cookie.replace(/(?:(?:^|.*;\s*)nickname\s*=\s*([^;]*).*$)|^.*$/,"$1");e&&(n.value=e,B())})),(e,t)=>{const o=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("nav",null,[r,n.value?((0,a.wg)(),(0,a.iD)("ul",u,[(0,a._)("li",d,[(0,a._)("a",p,[(0,a._)("span",null,(0,i.zw)(n.value)+" 的代辦",1)])]),(0,a._)("li",null,[(0,a._)("a",{href:"#",onClick:(0,s.iM)(J,["prevent"])},"登出",8,v)])])):((0,a.wg)(),(0,a.iD)("ul",_,[(0,a._)("li",f,[(0,a.Wm)(o,{to:"/login"},{default:(0,a.w5)((()=>[k])),_:1})]),(0,a._)("li",null,[(0,a.Wm)(o,{to:"/signup"},{default:(0,a.w5)((()=>[g])),_:1})])]))]),(0,a._)("div",y,[n.value?((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("div",w,[(0,a.wy)((0,a._)("input",{type:"text",class:"js-todoContent",placeholder:"請輸入待辦事項","onUpdate:modelValue":t[0]||(t[0]=e=>N.value=e)},null,512),[[s.nr,N.value]]),(0,a._)("a",{href:"#",onClick:(0,s.iM)(E,["prevent"])},C,8,m)]),(0,a._)("div",$,[(0,a._)("ul",T,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W.value,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.engType},[(0,a._)("a",{href:"#",class:(0,i.C_)({active:e.engType===Y.value}),onClick:(0,s.iM)((t=>G(e.engType)),["prevent"])},(0,i.zw)(e.chtType),11,b)])))),128))]),(0,a._)("div",L,[(0,a._)("ul",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(x.value,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.id},[(0,a._)("input",{class:"todoList_input",type:"checkbox",checked:e.completed_at,onChange:t=>F(e.id)},null,40,H),(0,a._)("span",null,(0,i.zw)(e.content),1),(0,a._)("a",j,[(0,a._)("button",{type:"button",class:"js-editTodo",onClick:t=>S(e.id)},"編輯",8,z),(0,a._)("button",{type:"button",class:"js-deleteTodo",onClick:t=>Z(e.id)},"刪除",8,M)])])))),128))]),(0,a._)("div",U,[(0,a._)("p",null,[(0,a._)("span",I,(0,i.zw)(P.value.length),1),O]),(0,a._)("a",{href:"#",class:"js-deleteAllTodo",onClick:(0,s.iM)(q,["prevent"])},"清除已完成項目",8,V)])])])])):((0,a.wg)(),(0,a.iD)("h2",A,"請先登入"))])])}}},N=o(89);const P=(0,N.Z)(K,[["__scopeId","data-v-bbf0c89a"]]);var W=P}}]);
//# sourceMappingURL=253.7cc2d5f0.js.map