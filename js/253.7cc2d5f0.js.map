{"version":3,"file":"js/253.7cc2d5f0.js","mappings":"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","sources":["webpack://todolist-api/./src/views/HomeView.vue","webpack://todolist-api/./src/views/HomeView.vue?1da1"],"sourcesContent":["<template>\r\n<div class=\"todoListView bg-half js-view\" >\r\n  <nav>\r\n    <h1><a href=\"#\">ONLINE TODO LIST</a></h1>\r\n    <ul v-if=\"nickname\">\r\n      <li class=\"todo_sm\"><a href=\"#\"><span>{{nickname}} 的代辦</span></a></li>\r\n      <li><a href=\"#\" @click.prevent=\"signOut\">登出</a></li>\r\n    </ul>\r\n    <ul v-else>\r\n      <li class=\"todo_sm\">\r\n        <router-link to=\"/login\">登入</router-link>\r\n      </li>\r\n      <li>\r\n        <router-link to=\"/signup\">註冊</router-link>\r\n      </li>\r\n    </ul>\r\n  </nav>\r\n  <div class=\"conatiner todoListPage vhContainer\">\r\n    <div class=\"todoList_Content\" v-if=\"nickname\">\r\n      <div class=\"inputBox\">\r\n        <!-- eslint-disable-next-line vuejs-accessibility/form-control-has-label -->\r\n        <input type=\"text\" class=\"js-todoContent\" placeholder=\"請輸入待辦事項\" v-model=\"todoContent\">\r\n        <a href=\"#\" @click.prevent=\"addTodo\">\r\n          <i class=\"js-addTodo\">+</i>\r\n        </a>\r\n      </div>\r\n      <div class=\"todoList_list\">\r\n        <ul class=\"todoList_tab\">\r\n          <li v-for=\"item in type\" :key=\"item.engType\">\r\n            <a href=\"#\" :class=\"{active: item.engType === currentType}\"\r\n            @click.prevent=\"toggleType(item.engType)\">{{ item.chtType }}</a></li>\r\n        </ul>\r\n        <div class=\"todoList_items\">\r\n          <ul class=\"todoList_item\">\r\n            <li v-for=\"item in todolistList\" :key=\"item.id\">\r\n                <!-- eslint-disable-next-line vuejs-accessibility/form-control-has-label -->\r\n                <input class=\"todoList_input\" type=\"checkbox\" :checked=\"item.completed_at\"\r\n                @change=\"toggleState(item.id)\">\r\n                <span>{{ item.content }}</span>\r\n                <!-- eslint-disable-next-line vuejs-accessibility/anchor-has-content -->\r\n                <a href=\"#\">\r\n                    <button type=\"button\" class=\"js-editTodo\"\r\n                    @click=\"modifyTodo(item.id)\">編輯</button>\r\n                    <button type=\"button\" class=\"js-deleteTodo\"\r\n                    @click=\"deleteTodo(item.id)\">刪除</button>\r\n                </a>\r\n            </li>\r\n          </ul>\r\n          <div class=\"todoList_statistics\">\r\n            <p> <span class=\"js-todoList_statistics\">{{ doneProject.length }}</span> 個已完成項目</p>\r\n            <a href=\"#\" class=\"js-deleteAllTodo\" @click.prevent=\"deleteDoneTodo\">清除已完成項目</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <h2 v-else>請先登入</h2>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/assets/main.scss';\r\n\r\nh2 {\r\n  font-size: 72px;\r\n  text-align: center;\r\n}\r\n\r\n</style>\r\n\r\n<script setup>\r\nimport {\r\n  ref, inject, onMounted, watchEffect,\r\n} from 'vue';\r\n\r\nconst axios = inject('axios');\r\nconst swal = inject('$swal');\r\n\r\nconst nickname = ref('');\r\nconst todolistList = ref([]);\r\nconst todolistData = ref({ todos: [] });\r\nconst todoContent = ref('');\r\nconst doneProject = ref([]);\r\nconst type = ref([\r\n  { chtType: '全部', engType: 'all' },\r\n  { chtType: '待完成', engType: 'undone' },\r\n  { chtType: '已完成', engType: 'done' },\r\n]);\r\nconst currentType = ref('all');\r\n\r\nconst getTodolist = async () => {\r\n  try {\r\n    const { data } = await axios.get('todos');\r\n    todolistData.value = data;\r\n    todolistList.value = todolistData.value.todos;\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: '目前服務不可用，請之後重新在試。',\r\n    });\r\n  }\r\n};\r\n\r\nconst addTodo = async () => {\r\n  try {\r\n    if (!todoContent.value) {\r\n      swal.fire({\r\n        icon: 'error',\r\n        title: '失敗',\r\n        text: '欄位不可為空',\r\n      });\r\n      return;\r\n    }\r\n    await axios.post('todos', { todo: { content: todoContent.value } });\r\n    todoContent.value = '';\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '新增成功。',\r\n    });\r\n    await getTodolist();\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nconst modifyTodo = async (id) => {\r\n  try {\r\n    if (!todoContent.value) {\r\n      swal.fire({\r\n        icon: 'error',\r\n        title: '失敗',\r\n        text: '新增欄位亦是編輯欄位，欄位不可為空',\r\n      });\r\n      return;\r\n    }\r\n    await axios.put(`todos/${id}`, { todo: { content: todoContent.value } });\r\n    todoContent.value = '';\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '修改成功。',\r\n    });\r\n    await getTodolist();\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nconst deleteTodo = async (id) => {\r\n  try {\r\n    await axios.delete(`todos/${id}`);\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '刪除成功。',\r\n    });\r\n    await getTodolist();\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nconst deleteDoneTodo = async () => {\r\n  try {\r\n    const doneTodoList = doneProject.value;\r\n    await Promise.all(doneTodoList.map((item) => axios.delete(`todos/${item.id}`)));\r\n    // ryo code\r\n    //\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '成功清除已完成項目。',\r\n    });\r\n    await getTodolist();\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nconst toggleState = async (id) => {\r\n  try {\r\n    await axios.patch(`todos/${id}/toggle`);\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '切換狀態成功。',\r\n    });\r\n    await getTodolist();\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nconst toggleType = (engType) => {\r\n  currentType.value = engType;\r\n  if (engType === 'all') {\r\n    todolistList.value = todolistData.value.todos;\r\n  } else if (engType === 'undone') {\r\n    todolistList.value = todolistData.value.todos.filter((item) => item.completed_at === null);\r\n  } else {\r\n    todolistList.value = todolistData.value.todos.filter((item) => item.completed_at !== null);\r\n  }\r\n};\r\n\r\nconst signOut = async () => {\r\n  try {\r\n    await axios.delete('users/sign_out');\r\n    document.cookie = 'token=; max-age=1;';\r\n    document.cookie = 'nickname=; max-age=1;';\r\n    axios.defaults.headers.common.Authorization = document.cookie.replace(/(?:(?:^|.*;\\s*)token\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\r\n    nickname.value = '';\r\n    swal.fire({\r\n      icon: 'success',\r\n      title: '成功',\r\n      text: '登出成功。',\r\n    });\r\n  } catch (error) {\r\n    swal.fire({\r\n      icon: 'error',\r\n      title: '失敗',\r\n      text: `${error.response.data.message}`,\r\n    });\r\n  }\r\n};\r\n\r\nwatchEffect(async () => {\r\n  doneProject.value = await todolistData.value.todos.filter((item) => item.completed_at !== null);\r\n  console.log(todolistData.value.todos);\r\n  console.log(doneProject.value);\r\n});\r\n\r\nonMounted(() => {\r\n  const getNicknameCookie = document.cookie.replace(/(?:(?:^|.*;\\s*)nickname\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\r\n  if (getNicknameCookie) {\r\n    nickname.value = getNicknameCookie;\r\n    getTodolist();\r\n  }\r\n});\r\n\r\n</script>\r\n","import script from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./HomeView.vue?vue&type=style&index=0&id=bbf0c89a&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Front End\\\\Vue\\\\todolist-api\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bbf0c89a\"]])\n\nexport default __exports__"],"names":["axios","inject","swal","nickname","ref","todolistList","todolistData","todos","todoContent","doneProject","type","chtType","engType","currentType","getTodolist","async","data","get","value","error","fire","icon","title","text","addTodo","post","todo","content","response","message","modifyTodo","put","id","deleteTodo","delete","deleteDoneTodo","doneTodoList","Promise","all","map","item","toggleState","patch","toggleType","filter","completed_at","signOut","document","cookie","defaults","headers","common","Authorization","replace","watchEffect","console","log","onMounted","getNicknameCookie","__exports__"],"sourceRoot":""}